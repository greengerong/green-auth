"use strict";angular.module("green.auth",[]).factory("authInterceptor",["$q","authService",function(a,b){return{request:function(c){c.headers=c.headers||{};var d=b.getToken()||{};return angular.forEach(d,function(a,b){c.headers[b]||(c.headers[b]=a)}),c||a.when(c)}}}]).factory("responseInterceptor",["$q","$rootScope",function(a,b){return{responseError:function(c){return b.$broadcast("green-auth-event:response-error",c),a.reject(c)},response:function(c){return b.$broadcast("green-auth-event:response-success",c),c||a.when(c)}}}]).constant("tokenCacheFactory",{jsObject:function(){var a;return[function(){return{save:function(b){return a=angular.copy(b)},get:function(){return a},remove:function(){a=null}}}]},localStorage:function(a){return["$window",function(b){return{save:function(c){return b.localStorage.setItem(a,angular.toJson(c)),c},get:function(){var c=b.localStorage.getItem(a);return c?angular.fromJson(c):null},remove:function(){b.localStorage.removeItem(a)}}}]},sessionStorage:function(a){return["$window",function(b){return{save:function(c){return b.sessionStorage.setItem(a,angular.toJson(c)),c},get:function(){var c=b.sessionStorage.getItem(a);return c?angular.fromJson(c):null},remove:function(){b.sessionStorage.removeItem(a)}}}]}}).provider("authService",function(){var a,b,c=this;c.setCacheFactory=function(a){return b=a,c},c.$get=["tokenCacheFactory","$injector",function(c,d){return b=b||c.jsObject(),a=d.invoke(b),{setToken:function(b){return a.save(b)},getToken:function(){return a.get()},removeToken:function(){return a.remove()}}}]}).config(["$httpProvider",function(a){a.interceptors.push("authInterceptor","responseInterceptor")}]);